{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/christofferwallman/Desktop/Utveckling/NORAV1.2/src/components/OnboardingLoader.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { CheckCircle2, Sparkles, Globe, BrainCircuit } from 'lucide-react';\nimport { clsx, type ClassValue } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n// Helper för renare tailwind-klasser\nfunction cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\ninterface OnboardingLoaderProps {\n  url: string;\n  onReady: () => void;\n  scrapedPageCount: number | null; // Ny prop för faktiskt antal sidor\n}\n\nexport const OnboardingLoader: React.FC<OnboardingLoaderProps> = ({ url, onReady, scrapedPageCount }) => {\n  const [progress, setProgress] = useState(0);\n  const [currentStep, setCurrentStep] = useState(0);\n\n  // Status-stegen\n  const steps = [\n    {\n      id: 0,\n      text: `Ansluter till ${url}...`,\n      icon: Globe,\n      duration: 5000, // 5s\n      progressEnd: 15\n    },\n    {\n      id: 1,\n      // Använd dynamiskt antal om tillgängligt, annars \"...\"\n      text: scrapedPageCount \n        ? `Hittade ${scrapedPageCount} sidor. Läser prissättning och tjänster...`\n        : \"Letar efter undersidor...\",\n      icon: Sparkles,\n      duration: 10000, // 10s\n      progressEnd: 50\n    },\n    {\n      id: 2,\n      text: \"Analyserar kärnverksamhet och villkor. Genererar Noras kunskapsbas...\",\n      icon: BrainCircuit,\n      duration: 15000, // 15s\n      progressEnd: 95\n    },\n    {\n      id: 3,\n      text: \"Klar! NORA förstår nu din verksamhet.\",\n      icon: CheckCircle2,\n      duration: 0,\n      progressEnd: 100\n    }\n  ];\n\n  useEffect(() => {\n    let timer: NodeJS.Timeout;\n    let startTime = Date.now();\n    let animationFrame: number;\n    \n    // Hantera tidslinjen\n    const runSequence = () => {\n      const now = Date.now();\n      const elapsed = now - startTime;\n\n      // STEG 1: Initiering (0-5s)\n      if (elapsed < 5000) {\n        setCurrentStep(0);\n        setProgress(Math.min(15, (elapsed / 5000) * 15));\n      } \n      // STEG 2: Väntar på scraping (5s -> tills klar)\n      else if (!scrapedPageCount) {\n        // Vi stannar kvar på steg 0 eller 1 \"Letar...\" tills vi fått svar\n        // Men vi kan fejka en långsam progress upp till 45% så det inte ser dött ut\n        setCurrentStep(0); // Eller byt till en \"Searching...\" status\n        const slowProgress = 15 + Math.min(30, (elapsed - 5000) / 1000); // Segar sig uppåt\n        setProgress(slowProgress);\n      }\n      // STEG 3: Scraping klar, kör analys-stegen (snabbspola eller kör normalt)\n      else if (currentStep < 2) {\n         // Hoppa direkt till \"Hittade X sidor\" och fortsätt därifrån\n         setCurrentStep(1); \n         // Nu låter vi den köra klart sina animationer lite snabbare för bra flow\n         // ... (förenklad logik för demo: vi låter den bara ticka vidare baserat på tid nu)\n      }\n\n      // FÖRENKLAD LOGIK FÖR DEMO (Ersätter ovanstående komplexitet för stabilitet):\n      // Vi kör en ren tidsbaserad loop, men uppdaterar TEXTEN dynamiskt i steps[1].\n      // Om scrapingen går supersnabbt hinner man kanske inte se \"Letar...\", men det är ok.\n      \n      if (elapsed < 5000) {\n         setCurrentStep(0);\n         setProgress((elapsed / 5000) * 15);\n      } else if (elapsed < 12000) {\n         setCurrentStep(1);\n         // 15 -> 50\n         const p = (elapsed - 5000) / 7000;\n         setProgress(15 + p * 35);\n      } else if (elapsed < 20000) {\n         setCurrentStep(2);\n         // 50 -> 95\n         const p = (elapsed - 12000) / 8000;\n         setProgress(50 + p * 45);\n      } else {\n         setCurrentStep(3);\n         setProgress(100);\n         return;\n      }\n\n      animationFrame = requestAnimationFrame(runSequence);\n    };\n\n    animationFrame = requestAnimationFrame(runSequence);\n\n    return () => cancelAnimationFrame(animationFrame);\n  }, []); // Notera: Vi borde ha scrapedPageCount i deps om vi vill reagera direkt, men för text-uppdateringen räcker det att komponenten renderas om.\n\n  const isComplete = currentStep === 3;\n\n  return (\n    <div className=\"flex flex-col items-center justify-center w-full max-w-md mx-auto p-6 text-center space-y-8\">\n      \n      {/* 1. Animerad AI-cirkel (Pulse effect) */}\n      <div className=\"relative flex items-center justify-center\">\n        {/* Yttre glöd */}\n        <motion.div\n          animate={{ scale: [1, 1.2, 1], opacity: [0.3, 0.1, 0.3] }}\n          transition={{ duration: 2, repeat: Infinity, ease: \"easeInOut\" }}\n          className=\"absolute w-32 h-32 rounded-full bg-violet-600 blur-2xl\"\n        />\n        \n        {/* Inre cirkel */}\n        <div className=\"relative bg-white/5 backdrop-blur-sm border border-violet-500/30 w-24 h-24 rounded-full flex items-center justify-center shadow-2xl\">\n           <AnimatePresence mode='wait'>\n            <motion.div\n              key={steps[currentStep].id}\n              initial={{ opacity: 0, scale: 0.5, rotate: -20 }}\n              animate={{ opacity: 1, scale: 1, rotate: 0 }}\n              exit={{ opacity: 0, scale: 0.5, rotate: 20 }}\n              transition={{ duration: 0.3 }}\n            >\n              {React.createElement(steps[currentStep].icon, {\n                className: cn(\n                  \"w-10 h-10 transition-colors duration-500\",\n                  isComplete ? \"text-green-400\" : \"text-violet-400\"\n                )\n              })}\n            </motion.div>\n          </AnimatePresence>\n        </div>\n      </div>\n\n      {/* 2. Status Ticker */}\n      <div className=\"h-24 w-full flex flex-col items-center justify-center overflow-hidden\">\n        <AnimatePresence mode='wait'>\n          <motion.h2\n            key={steps[currentStep].id}\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n            transition={{ duration: 0.5, ease: \"easeOut\" }}\n            className=\"text-xl font-medium text-slate-100\"\n          >\n            {steps[currentStep].text}\n          </motion.h2>\n        </AnimatePresence>\n        \n        {/* Progress bar */}\n        <div className=\"w-full h-1.5 bg-slate-800 rounded-full mt-4 overflow-hidden relative\">\n          <motion.div \n            className=\"h-full bg-gradient-to-r from-violet-600 to-indigo-500 shadow-[0_0_10px_rgba(124,58,237,0.5)]\"\n            initial={{ width: \"0%\" }}\n            animate={{ width: `${progress}%` }}\n            transition={{ ease: \"linear\" }}\n          />\n        </div>\n      </div>\n\n      {/* 3. Förtroendebyggande text */}\n      {!isComplete && (\n        <motion.p \n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ delay: 1 }}\n          className=\"text-xs text-slate-400 max-w-xs leading-relaxed\"\n        >\n          NORA läser just nu igenom er unika data för att kunna ge exakta svar och representera ert varumärke perfekt. Detta säkerställer att inga hallucinationer sker.\n        </motion.p>\n      )}\n\n      {/* 4. Action Button (Visas när klar) */}\n      <AnimatePresence>\n        {isComplete && (\n          <motion.div\n            initial={{ opacity: 0, y: 20, scale: 0.95 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            transition={{ type: \"spring\", stiffness: 200, damping: 20 }}\n            className=\"w-full pt-4\"\n          >\n            <button\n              onClick={onReady}\n              className=\"group relative w-full py-3.5 px-6 rounded-xl bg-violet-600 hover:bg-violet-500 text-white font-semibold shadow-lg shadow-violet-500/25 transition-all active:scale-[0.98]\"\n            >\n              <span className=\"flex items-center justify-center gap-2\">\n                Starta chatten med NORA\n                <Sparkles className=\"w-4 h-4 text-violet-200 group-hover:text-white transition-colors\" />\n              </span>\n              \n              {/* Shine effekt */}\n              {/* Uppdaterad med 'animate-shimmer' istället för inline styles */}\n              <div className=\"absolute inset-0 rounded-xl overflow-hidden pointer-events-none\">\n                <div className=\"absolute top-0 left-[-100%] w-1/2 h-full bg-gradient-to-r from-transparent via-white/20 to-transparent skew-x-[-20deg] animate-shimmer\" />\n              </div>\n            </button>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;AAEA,qCAAqC;AACrC,SAAS,GAAG,GAAG,MAAoB;IACjC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB;AAQO,MAAM,mBAAoD,CAAC,EAAE,GAAG,EAAE,OAAO,EAAE,gBAAgB,EAAE;IAClG,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAE/C,gBAAgB;IAChB,MAAM,QAAQ;QACZ;YACE,IAAI;YACJ,MAAM,CAAC,cAAc,EAAE,IAAI,GAAG,CAAC;YAC/B,MAAM,6MAAK;YACX,UAAU;YACV,aAAa;QACf;QACA;YACE,IAAI;YACJ,uDAAuD;YACvD,MAAM,mBACF,CAAC,QAAQ,EAAE,iBAAiB,0CAA0C,CAAC,GACvE;YACJ,MAAM,sNAAQ;YACd,UAAU;YACV,aAAa;QACf;QACA;YACE,IAAI;YACJ,MAAM;YACN,MAAM,sOAAY;YAClB,UAAU;YACV,aAAa;QACf;QACA;YACE,IAAI;YACJ,MAAM;YACN,MAAM,qOAAY;YAClB,UAAU;YACV,aAAa;QACf;KACD;IAED,IAAA,kNAAS,EAAC;QACR,IAAI;QACJ,IAAI,YAAY,KAAK,GAAG;QACxB,IAAI;QAEJ,qBAAqB;QACrB,MAAM,cAAc;YAClB,MAAM,MAAM,KAAK,GAAG;YACpB,MAAM,UAAU,MAAM;YAEtB,4BAA4B;YAC5B,IAAI,UAAU,MAAM;gBAClB,eAAe;gBACf,YAAY,KAAK,GAAG,CAAC,IAAI,AAAC,UAAU,OAAQ;YAC9C,OAEK,IAAI,CAAC,kBAAkB;gBAC1B,kEAAkE;gBAClE,4EAA4E;gBAC5E,eAAe,IAAI,0CAA0C;gBAC7D,MAAM,eAAe,KAAK,KAAK,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,OAAO,kBAAkB;gBACnF,YAAY;YACd,OAEK,IAAI,cAAc,GAAG;gBACvB,4DAA4D;gBAC5D,eAAe;YACf,yEAAyE;YACzE,mFAAmF;YACtF;YAEA,8EAA8E;YAC9E,8EAA8E;YAC9E,qFAAqF;YAErF,IAAI,UAAU,MAAM;gBACjB,eAAe;gBACf,YAAY,AAAC,UAAU,OAAQ;YAClC,OAAO,IAAI,UAAU,OAAO;gBACzB,eAAe;gBACf,WAAW;gBACX,MAAM,IAAI,CAAC,UAAU,IAAI,IAAI;gBAC7B,YAAY,KAAK,IAAI;YACxB,OAAO,IAAI,UAAU,OAAO;gBACzB,eAAe;gBACf,WAAW;gBACX,MAAM,IAAI,CAAC,UAAU,KAAK,IAAI;gBAC9B,YAAY,KAAK,IAAI;YACxB,OAAO;gBACJ,eAAe;gBACf,YAAY;gBACZ;YACH;YAEA,iBAAiB,sBAAsB;QACzC;QAEA,iBAAiB,sBAAsB;QAEvC,OAAO,IAAM,qBAAqB;IACpC,GAAG,EAAE,GAAG,4IAA4I;IAEpJ,MAAM,aAAa,gBAAgB;IAEnC,qBACE,8OAAC;QAAI,WAAU;;0BAGb,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC,oMAAM,CAAC,GAAG;wBACT,SAAS;4BAAE,OAAO;gCAAC;gCAAG;gCAAK;6BAAE;4BAAE,SAAS;gCAAC;gCAAK;gCAAK;6BAAI;wBAAC;wBACxD,YAAY;4BAAE,UAAU;4BAAG,QAAQ;4BAAU,MAAM;wBAAY;wBAC/D,WAAU;;;;;;kCAIZ,8OAAC;wBAAI,WAAU;kCACZ,cAAA,8OAAC,4MAAe;4BAAC,MAAK;sCACrB,cAAA,8OAAC,oMAAM,CAAC,GAAG;gCAET,SAAS;oCAAE,SAAS;oCAAG,OAAO;oCAAK,QAAQ,CAAC;gCAAG;gCAC/C,SAAS;oCAAE,SAAS;oCAAG,OAAO;oCAAG,QAAQ;gCAAE;gCAC3C,MAAM;oCAAE,SAAS;oCAAG,OAAO;oCAAK,QAAQ;gCAAG;gCAC3C,YAAY;oCAAE,UAAU;gCAAI;0CAE3B,cAAA,gNAAK,CAAC,aAAa,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE;oCAC5C,WAAW,GACT,4CACA,aAAa,mBAAmB;gCAEpC;+BAXK,KAAK,CAAC,YAAY,CAAC,EAAE;;;;;;;;;;;;;;;;;;;;;0BAkBlC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,4MAAe;wBAAC,MAAK;kCACpB,cAAA,8OAAC,oMAAM,CAAC,EAAE;4BAER,SAAS;gCAAE,SAAS;gCAAG,GAAG;4BAAG;4BAC7B,SAAS;gCAAE,SAAS;gCAAG,GAAG;4BAAE;4BAC5B,MAAM;gCAAE,SAAS;gCAAG,GAAG,CAAC;4BAAG;4BAC3B,YAAY;gCAAE,UAAU;gCAAK,MAAM;4BAAU;4BAC7C,WAAU;sCAET,KAAK,CAAC,YAAY,CAAC,IAAI;2BAPnB,KAAK,CAAC,YAAY,CAAC,EAAE;;;;;;;;;;kCAY9B,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,oMAAM,CAAC,GAAG;4BACT,WAAU;4BACV,SAAS;gCAAE,OAAO;4BAAK;4BACvB,SAAS;gCAAE,OAAO,GAAG,SAAS,CAAC,CAAC;4BAAC;4BACjC,YAAY;gCAAE,MAAM;4BAAS;;;;;;;;;;;;;;;;;YAMlC,CAAC,4BACA,8OAAC,oMAAM,CAAC,CAAC;gBACP,SAAS;oBAAE,SAAS;gBAAE;gBACtB,SAAS;oBAAE,SAAS;gBAAE;gBACtB,YAAY;oBAAE,OAAO;gBAAE;gBACvB,WAAU;0BACX;;;;;;0BAMH,8OAAC,4MAAe;0BACb,4BACC,8OAAC,oMAAM,CAAC,GAAG;oBACT,SAAS;wBAAE,SAAS;wBAAG,GAAG;wBAAI,OAAO;oBAAK;oBAC1C,SAAS;wBAAE,SAAS;wBAAG,GAAG;wBAAG,OAAO;oBAAE;oBACtC,YAAY;wBAAE,MAAM;wBAAU,WAAW;wBAAK,SAAS;oBAAG;oBAC1D,WAAU;8BAEV,cAAA,8OAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,8OAAC;gCAAK,WAAU;;oCAAyC;kDAEvD,8OAAC,sNAAQ;wCAAC,WAAU;;;;;;;;;;;;0CAKtB,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ/B"}},
    {"offset": {"line": 357, "column": 0}, "map": {"version":3,"sources":["file:///Users/christofferwallman/Desktop/Utveckling/NORAV1.2/src/components/ChatInterface.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport { Send, Bot, User, Sparkles } from 'lucide-react';\n\ninterface ChatInterfaceProps {\n  companyId: string; // Viktigt för att NORA ska veta vilken data hon ska söka i\n}\n\ninterface Message {\n  role: 'user' | 'assistant';\n  content: string;\n}\n\nexport const ChatInterface: React.FC<ChatInterfaceProps> = ({ companyId }) => {\n  const [messages, setMessages] = useState<Message[]>([\n    { role: 'assistant', content: 'Hej! Jag är NORA. Jag har läst på om er verksamhet. Vad vill du veta?' }\n  ]);\n  const [inputValue, setInputValue] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  // Auto-scroll till botten\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleSendMessage = async (e?: React.FormEvent) => {\n    e?.preventDefault();\n    if (!inputValue.trim() || isLoading) return;\n\n    const userMsg = inputValue.trim();\n    setInputValue('');\n    \n    // Lägg till användarens meddelande och ett tomt meddelande för AI\n    setMessages(prev => [\n      ...prev, \n      { role: 'user', content: userMsg },\n      { role: 'assistant', content: '' } // Platshållare för streamat svar\n    ]);\n    setIsLoading(true);\n\n    try {\n      const response = await fetch('/api/chat', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ \n          message: userMsg, \n          companyId: companyId \n        }),\n      });\n\n      if (!response.ok || !response.body) {\n        throw new Error(response.statusText);\n      }\n\n      // Hantera streaming response\n      const reader = response.body.getReader();\n      const decoder = new TextDecoder();\n      let done = false;\n      let accumulatedText = \"\";\n\n      while (!done) {\n        const { value, done: doneReading } = await reader.read();\n        done = doneReading;\n        const chunkValue = decoder.decode(value, { stream: true });\n        accumulatedText += chunkValue;\n\n        // Uppdatera det sista meddelandet (AI:ns svar) i realtid\n        setMessages(prev => {\n          const newMessages = [...prev];\n          const lastMsg = newMessages[newMessages.length - 1];\n          if (lastMsg.role === 'assistant') {\n            lastMsg.content = accumulatedText;\n          }\n          return newMessages;\n        });\n      }\n\n    } catch (error) {\n      console.error(error);\n      setMessages(prev => {\n        // Ta bort det tomma meddelandet om det blev fel, eller visa felmeddelande\n        const newMessages = [...prev];\n        const lastMsg = newMessages[newMessages.length - 1];\n        if (lastMsg.role === 'assistant' && !lastMsg.content) {\n            lastMsg.content = \"Hoppsan, jag tappade tråden lite. Kan du försöka igen?\";\n        }\n        return newMessages;\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-[600px] w-full max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden border border-slate-100\">\n      \n      {/* Header */}\n      <div className=\"bg-slate-50 p-4 border-b border-slate-100 flex items-center gap-3\">\n        <div className=\"w-10 h-10 rounded-full bg-violet-600 flex items-center justify-center shadow-lg shadow-violet-200\">\n           <Bot className=\"text-white w-6 h-6\" />\n        </div>\n        <div>\n          <h3 className=\"font-semibold text-slate-800\">NORA Demo</h3>\n          <p className=\"text-xs text-slate-500 flex items-center gap-1\">\n            <span className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\" />\n            Online & Utbildad på din data\n          </p>\n        </div>\n      </div>\n\n      {/* Messages Area */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-6 bg-slate-50/50\">\n        {messages.map((msg, idx) => (\n          <motion.div\n            key={idx}\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            className={`flex gap-3 ${msg.role === 'user' ? 'flex-row-reverse' : ''}`}\n          >\n            {/* Avatar */}\n            <div className={`w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${\n              msg.role === 'user' ? 'bg-slate-200' : 'bg-violet-100'\n            }`}>\n              {msg.role === 'user' ? (\n                <User className=\"w-5 h-5 text-slate-500\" />\n              ) : (\n                <Sparkles className=\"w-5 h-5 text-violet-600\" />\n              )}\n            </div>\n\n            {/* Bubble */}\n            <div className={`max-w-[80%] p-4 rounded-2xl text-sm leading-relaxed shadow-sm ${\n              msg.role === 'user' \n                ? 'bg-violet-600 text-white rounded-tr-none' \n                : 'bg-white text-slate-700 border border-slate-100 rounded-tl-none'\n            }`}>\n              {msg.content}\n            </div>\n          </motion.div>\n        ))}\n\n        {/* Loading Indicator */}\n        {isLoading && (\n          <motion.div \n            initial={{ opacity: 0 }} \n            animate={{ opacity: 1 }} \n            className=\"flex gap-3\"\n          >\n            <div className=\"w-8 h-8 rounded-full bg-violet-100 flex items-center justify-center\">\n              <Sparkles className=\"w-5 h-5 text-violet-600\" />\n            </div>\n            <div className=\"bg-white p-4 rounded-2xl rounded-tl-none border border-slate-100 flex gap-1 items-center h-12\">\n              <span className=\"w-2 h-2 bg-violet-400 rounded-full animate-bounce [animation-delay:-0.3s]\" />\n              <span className=\"w-2 h-2 bg-violet-400 rounded-full animate-bounce [animation-delay:-0.15s]\" />\n              <span className=\"w-2 h-2 bg-violet-400 rounded-full animate-bounce\" />\n            </div>\n          </motion.div>\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Input Area */}\n      <form \n        onSubmit={handleSendMessage}\n        className=\"p-4 bg-white border-t border-slate-100 flex gap-2\"\n      >\n        <input\n          type=\"text\"\n          value={inputValue}\n          onChange={(e) => setInputValue(e.target.value)}\n          placeholder=\"Fråga NORA om din hemsida...\"\n          className=\"flex-1 bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-500 transition-all placeholder:text-slate-400\"\n          autoFocus\n        />\n        <button\n          type=\"submit\"\n          disabled={!inputValue.trim() || isLoading}\n          className=\"p-3 bg-violet-600 text-white rounded-xl hover:bg-violet-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-lg shadow-violet-200\"\n        >\n          <Send className=\"w-5 h-5\" />\n        </button>\n      </form>\n    </div>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 694, "column": 0}, "map": {"version":3,"sources":["file:///Users/christofferwallman/Desktop/Utveckling/NORAV1.2/src/components/DemoPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { OnboardingLoader } from './OnboardingLoader';\nimport { ChatInterface } from './ChatInterface';\nimport { ArrowRight } from 'lucide-react';\n\nexport const DemoPage = () => {\n  const [step, setStep] = useState<'input' | 'loading' | 'chat'>('input');\n  const [url, setUrl] = useState('');\n  const [companyId, setCompanyId] = useState('');\n  const [scrapedPageCount, setScrapedPageCount] = useState<number | null>(null);\n\n  const handleStartAnalysis = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!url) return;\n    \n    // Generera ett ID och byt state\n    const newCompanyId = `demo-${Date.now()}`;\n    setCompanyId(newCompanyId);\n    setStep('loading');\n    setScrapedPageCount(null); // Reset\n\n    try {\n      const response = await fetch('/api/ingest', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ url, companyId: newCompanyId }),\n      });\n\n      if (!response.body) return;\n\n      const reader = response.body.getReader();\n      const decoder = new TextDecoder();\n      let buffer = '';\n\n      while (true) {\n        const { done, value } = await reader.read();\n        if (done) break;\n\n        buffer += decoder.decode(value, { stream: true });\n        \n        // Hantera att flera JSON-objekt kan komma i samma chunk eller vara uppdelade\n        const lines = buffer.split('\\n');\n        buffer = lines.pop() || ''; // Spara det som inte är en komplett rad än\n\n        for (const line of lines) {\n          if (!line.trim()) continue;\n          try {\n            const data = JSON.parse(line);\n            if (data.type === 'scraped') {\n              console.log(\"Found pages:\", data.count);\n              setScrapedPageCount(data.count);\n            } else if (data.type === 'complete') {\n              console.log(\"Analysis complete\");\n              // Vi låter OnboardingLoader sköta övergången via onReady när animationen är klar\n            }\n          } catch (e) {\n            console.error(\"Error parsing stream JSON\", e);\n          }\n        }\n      }\n    } catch (error) {\n      console.error(\"Failed to start analysis\", error);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 flex items-center justify-center p-4\">\n      \n      {step === 'input' && (\n        <div className=\"max-w-md w-full text-center space-y-6\">\n          <h1 className=\"text-4xl font-bold text-slate-900 tracking-tight\">\n            Möt NORA.\n          </h1>\n          <p className=\"text-slate-500\">\n            Skriv in din URL så bygger hon en kunskapsbas och startar en chatt med dig på 30 sekunder.\n          </p>\n          \n          <form onSubmit={handleStartAnalysis} className=\"flex flex-col gap-3\">\n            <input \n              type=\"url\" \n              required\n              placeholder=\"https://dittföretag.se\" \n              value={url}\n              onChange={e => setUrl(e.target.value)}\n              className=\"w-full px-4 py-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-violet-500 focus:outline-none\"\n            />\n            <button \n              type=\"submit\"\n              className=\"w-full py-3 bg-violet-600 text-white rounded-lg font-medium hover:bg-violet-700 transition-colors flex items-center justify-center gap-2\"\n            >\n              Analysera hemsida <ArrowRight className=\"w-4 h-4\" />\n            </button>\n          </form>\n        </div>\n      )}\n\n      {/* \n        Vi renderar alltid ChatInterface när vi har lämnat 'input'-stadiet, \n        men vi döljer den med CSS (display: none) tills step === 'chat'.\n        Detta gör att komponenten \"laddas i bakgrunden\" och är redo direkt.\n      */}\n      {step !== 'input' && (\n        <>\n           <div className={step === 'chat' ? 'block w-full max-w-2xl' : 'hidden'}>\n              <ChatInterface companyId={companyId} />\n           </div>\n           \n           {step === 'loading' && (\n             <OnboardingLoader \n               url={url} \n               scrapedPageCount={scrapedPageCount}\n               onReady={() => setStep('chat')} \n             />\n           )}\n        </>\n      )}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;AAEO,MAAM,WAAW;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAA+B;IAC/D,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAC;IAC/B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAgB;IAExE,MAAM,sBAAsB,OAAO;QACjC,EAAE,cAAc;QAChB,IAAI,CAAC,KAAK;QAEV,gCAAgC;QAChC,MAAM,eAAe,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;QACzC,aAAa;QACb,QAAQ;QACR,oBAAoB,OAAO,QAAQ;QAEnC,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,eAAe;gBAC1C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAK,WAAW;gBAAa;YACtD;YAEA,IAAI,CAAC,SAAS,IAAI,EAAE;YAEpB,MAAM,SAAS,SAAS,IAAI,CAAC,SAAS;YACtC,MAAM,UAAU,IAAI;YACpB,IAAI,SAAS;YAEb,MAAO,KAAM;gBACX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,IAAI;gBACzC,IAAI,MAAM;gBAEV,UAAU,QAAQ,MAAM,CAAC,OAAO;oBAAE,QAAQ;gBAAK;gBAE/C,6EAA6E;gBAC7E,MAAM,QAAQ,OAAO,KAAK,CAAC;gBAC3B,SAAS,MAAM,GAAG,MAAM,IAAI,2CAA2C;gBAEvE,KAAK,MAAM,QAAQ,MAAO;oBACxB,IAAI,CAAC,KAAK,IAAI,IAAI;oBAClB,IAAI;wBACF,MAAM,OAAO,KAAK,KAAK,CAAC;wBACxB,IAAI,KAAK,IAAI,KAAK,WAAW;4BAC3B,QAAQ,GAAG,CAAC,gBAAgB,KAAK,KAAK;4BACtC,oBAAoB,KAAK,KAAK;wBAChC,OAAO,IAAI,KAAK,IAAI,KAAK,YAAY;4BACnC,QAAQ,GAAG,CAAC;wBACZ,iFAAiF;wBACnF;oBACF,EAAE,OAAO,GAAG;wBACV,QAAQ,KAAK,CAAC,6BAA6B;oBAC7C;gBACF;YACF;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;YAEZ,SAAS,yBACR,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAmD;;;;;;kCAGjE,8OAAC;wBAAE,WAAU;kCAAiB;;;;;;kCAI9B,8OAAC;wBAAK,UAAU;wBAAqB,WAAU;;0CAC7C,8OAAC;gCACC,MAAK;gCACL,QAAQ;gCACR,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAA,IAAK,OAAO,EAAE,MAAM,CAAC,KAAK;gCACpC,WAAU;;;;;;0CAEZ,8OAAC;gCACC,MAAK;gCACL,WAAU;;oCACX;kDACmB,8OAAC,gOAAU;wCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;YAW/C,SAAS,yBACR;;kCACG,8OAAC;wBAAI,WAAW,SAAS,SAAS,2BAA2B;kCAC1D,cAAA,8OAAC,oJAAa;4BAAC,WAAW;;;;;;;;;;;oBAG5B,SAAS,2BACR,8OAAC,0JAAgB;wBACf,KAAK;wBACL,kBAAkB;wBAClB,SAAS,IAAM,QAAQ;;;;;;;;;;;;;;AAOtC"}},
    {"offset": {"line": 871, "column": 0}, "map": {"version":3,"sources":["file:///Users/christofferwallman/Desktop/Utveckling/NORAV1.2/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React from 'react';\nimport { DemoPage } from '@/components/DemoPage';\n\nexport default function Home() {\n  return (\n    <main>\n      <DemoPage />\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAKe,SAAS;IACtB,qBACE,8OAAC;kBACC,cAAA,8OAAC,0IAAQ;;;;;;;;;;AAGf"}}]
}