{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/christofferwallman/Desktop/Utveckling/NORAV1.2/src/app/admin/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from 'react'; // React import\nimport { motion } from 'framer-motion';\nimport { Users, Mail, Phone, Calendar, MessageSquare, RefreshCw, ChevronRight, Trash2 } from 'lucide-react';\n\ninterface Lead {\n  id: number;\n  email: string;\n  phone: string;\n  message: string;\n  created_at: string;\n  company_id: string;\n}\n\nexport default function AdminDashboard() {\n  const [leads, setLeads] = useState<Lead[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Funktion för att radera lead (GDPR: Rätten att bli glömd)\n  const handleDelete = async (id: number) => {\n    if (!window.confirm('Är du säker? Detta raderar personuppgifterna permanent för att följa GDPR.')) {\n      return;\n    }\n\n    try {\n      const res = await fetch(`/api/admin/leads/${id}`, {\n        method: 'DELETE',\n      });\n\n      if (!res.ok) throw new Error('Kunde inte radera');\n      \n      // Uppdatera listan lokalt\n      setLeads(prev => prev.filter(l => l.id !== id));\n    } catch (e) {\n      console.error(e);\n      alert('Kunde inte radera leadet.');\n    }\n  };\n\n  const fetchLeads = async () => {\n    setIsLoading(true);\n    try {\n      const res = await fetch('/api/admin/leads'); // Hämta alla leads\n      const data = await res.json();\n      if (data.leads) {\n        setLeads(data.leads);\n      }\n    } catch (error) {\n      console.error(\"Failed to fetch leads\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchLeads();\n  }, []);\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 p-8 font-sans text-slate-900\">\n      <div className=\"max-w-5xl mx-auto\">\n        \n        {/* Header */}\n        <header className=\"mb-10 flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-slate-900 mb-2\">Leads Dashboard</h1>\n            <p className=\"text-slate-500\">Här samlas alla kontaktuppgifter som NORA fångat upp.</p>\n          </div>\n          <button \n            onClick={fetchLeads}\n            disabled={isLoading}\n            className=\"flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-violet-600 transition-all font-medium shadow-sm hover:shadow-md disabled:opacity-50\"\n          >\n            <RefreshCw className={`w-4 h-4 ${isLoading ? 'animate-spin' : ''}`} />\n            Uppdatera\n          </button>\n        </header>\n\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10\">\n          <div className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4\">\n            <div className=\"w-12 h-12 rounded-full bg-violet-100 flex items-center justify-center text-violet-600\">\n              <Users className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-slate-500 font-medium\">Totalt antal leads</p>\n              <h3 className=\"text-2xl font-bold text-slate-800\">{leads.length}</h3>\n            </div>\n          </div>\n          <div className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4\">\n             <div className=\"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-green-600\">\n              <Mail className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-slate-500 font-medium\">Har e-post</p>\n              <h3 className=\"text-2xl font-bold text-slate-800\">\n                {leads.filter(l => l.email).length}\n              </h3>\n            </div>\n          </div>\n           <div className=\"bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4\">\n             <div className=\"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-600\">\n              <Phone className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-slate-500 font-medium\">Har telefonnr</p>\n              <h3 className=\"text-2xl font-bold text-slate-800\">\n                {leads.filter(l => l.phone).length}\n              </h3>\n            </div>\n          </div>\n        </div>\n\n        {/* Leads List */}\n        <div className=\"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden\">\n          <div className=\"p-6 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center\">\n            <h2 className=\"font-semibold text-lg text-slate-800\">Senaste aktivitet</h2>\n            <span className=\"text-xs font-medium px-2 py-1 bg-violet-100 text-violet-700 rounded-full\">\n              Live\n            </span>\n          </div>\n\n          <div className=\"divide-y divide-slate-100\">\n            {leads.length === 0 && !isLoading && (\n              <div className=\"p-12 text-center text-slate-400\">\n                <p>Inga leads hittade än. Prata med NORA och lämna dina uppgifter!</p>\n              </div>\n            )}\n\n            {leads.map((lead, idx) => (\n              <motion.div \n                key={lead.id}\n                initial={{ opacity: 0, x: -10 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: idx * 0.05 }}\n                className=\"p-6 hover:bg-slate-50 transition-colors group flex flex-col md:flex-row gap-6 md:items-center\"\n              >\n                {/* Icon / Avatar */}\n                <div className=\"shrink-0\">\n                  <div className=\"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 font-bold text-sm\">\n                    {(lead.email || lead.phone || '?')[0].toUpperCase()}\n                  </div>\n                </div>\n\n                {/* Content */}\n                <div className=\"flex-1 min-w-0 grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  \n                  {/* Contact Info */}\n                  <div className=\"space-y-1\">\n                    <div className=\"flex items-center gap-2 text-sm text-slate-900 font-medium truncate\">\n                      {lead.email ? (\n                        <>\n                          <Mail className=\"w-3.5 h-3.5 text-slate-400\" />\n                          <span className=\"truncate\">{lead.email}</span>\n                        </>\n                      ) : (\n                        <span className=\"text-slate-400 italic\">Ingen e-post</span>\n                      )}\n                    </div>\n                    <div className=\"flex items-center gap-2 text-sm text-slate-600 truncate\">\n                      {lead.phone ? (\n                        <>\n                          <Phone className=\"w-3.5 h-3.5 text-slate-400\" />\n                          <span>{lead.phone}</span>\n                        </>\n                      ) : (\n                         <span className=\"text-slate-400 italic text-xs\">Inget telefonnr</span>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Message Context */}\n                  <div className=\"md:col-span-2\">\n                    <div className=\"bg-slate-50 p-3 rounded-lg border border-slate-100 relative\">\n                       <MessageSquare className=\"w-4 h-4 text-violet-300 absolute -top-2 -left-2 bg-white rounded-full\" />\n                       <p className=\"text-sm text-slate-600 line-clamp-2 italic\">\n                         \"{lead.message}\"\n                       </p>\n                    </div>\n                  </div>\n                \n                </div>\n\n                {/* Meta / Actions */}\n                <div className=\"flex flex-row md:flex-col items-center md:items-end justify-between gap-2 shrink-0 border-t md:border-t-0 border-slate-100 pt-4 md:pt-0 mt-4 md:mt-0\">\n                  <div className=\"flex items-center gap-1.5 text-xs text-slate-400 whitespace-nowrap\" title={new Date(lead.created_at).toLocaleString()}>\n                    <Calendar className=\"w-3.5 h-3.5\" />\n                    {new Date(lead.created_at).toLocaleDateString('sv-SE')} \n                    <span className=\"text-slate-300\">|</span>\n                    {new Date(lead.created_at).toLocaleTimeString('sv-SE', {hour: '2-digit', minute:'2-digit'})}\n                  </div>\n                  \n                   <div className=\"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                    <button \n                      onClick={() => handleDelete(lead.id)}\n                      className=\"text-xs font-medium text-red-500 hover:text-red-600 flex items-center gap-1 px-2 py-1 hover:bg-red-50 rounded\"\n                      title=\"Radera personuppgifter (GDPR)\"\n                    >\n                      <Trash2 className=\"w-3 h-3\" /> Radera\n                    </button>\n                    <button className=\"text-xs font-medium text-violet-600 hover:text-violet-700 flex items-center gap-1\">\n                      Visa detaljer <ChevronRight className=\"w-3 h-3\" />\n                    </button>\n                  </div>\n                </div>\n\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}